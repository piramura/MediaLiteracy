const scriptAlertMessages = {
  noInput: {
    'æ—¥æœ¬èª': 'ä½•ã‚‚å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'ãƒ­ãƒ¼ãƒå­—': 'ä½•ã‚‚å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“',
    'English': 'Nothing entered.'
  },
  emptyMorse: {
    'æ—¥æœ¬èª': 'ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ãŒç©ºã§ã™ã€‚\nãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
    'ãƒ­ãƒ¼ãƒå­—': 'ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ãŒç©ºã§ã™ã€‚\nãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
    'English': 'Morse code is empty.\nPlease enter Morse code.'
  },
  invalidMorse: {
    'æ—¥æœ¬èª': 'å­˜åœ¨ã—ãªã„ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:\n',
    'ãƒ­ãƒ¼ãƒå­—': 'å­˜åœ¨ã—ãªã„ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:\n',
    'English': 'Invalid Morse code detected:\n'
  },
  selectFile: {
    'æ—¥æœ¬èª': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„',
    'ãƒ­ãƒ¼ãƒå­—': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„',
    'English': 'Please select a file.'
  },
  analysisFailed: {
    'æ—¥æœ¬èª': 'è§£æã«å¤±æ•—ã—ã¾ã—ãŸ: ',
    'ãƒ­ãƒ¼ãƒå­—': 'è§£æã«å¤±æ•—ã—ã¾ã—ãŸ: ',
    'English': 'Analysis failed: '
  },
  noAnalysisResult: {
    'æ—¥æœ¬èª': 'è§£æçµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšéŸ³å£°ã‚’è§£æã—ã¦ãã ã•ã„',
    'ãƒ­ãƒ¼ãƒå­—': 'è§£æçµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšéŸ³å£°ã‚’è§£æã—ã¦ãã ã•ã„',
    'English': 'No analysis result. Please analyze audio first.'
  },
  noMorseAnalyzed: {
    'æ—¥æœ¬èª': 'è§£æã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ«ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšè§£æã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚',
    'ãƒ­ãƒ¼ãƒå­—': 'è§£æã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ«ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšè§£æã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚',
    'English': 'No analyzed Morse code. Please run analysis first.'
  },
  noDecodedString: {
    'æ—¥æœ¬èª': 'è§£æã«ã‚ˆã‚Šæ–‡å­—åˆ—ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ',
    'ãƒ­ãƒ¼ãƒå­—': 'è§£æã«ã‚ˆã‚Šæ–‡å­—åˆ—ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ',
    'English': 'Failed to get string from analysis.'
  },
  noRomajiInResult: {
    'æ—¥æœ¬èª': 'è§£æçµæœã«ãƒ­ãƒ¼ãƒå­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“',
    'ãƒ­ãƒ¼ãƒå­—': 'è§£æçµæœã«ãƒ­ãƒ¼ãƒå­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“',
    'English': 'Analysis result contains no romaji.'
  }
};

function getScriptLanguage() {
  const globalLang = document.getElementById('globalLanguage');
  if (globalLang) return globalLang.value;
  const lang = document.getElementById('language') || document.getElementById('language2') || document.getElementById('language3');
  if (lang) return lang.value;
  return localStorage.getItem('ml_language') || 'æ—¥æœ¬èª';
}

function getScriptAlertMessage(key, defaultMsg = '') {
  const lang = getScriptLanguage();
  const msgObj = scriptAlertMessages[key];
  if (!msgObj) return defaultMsg;
  return msgObj[lang] || msgObj['æ—¥æœ¬èª'] || defaultMsg;
}

   const iroha = [
                ["ã‚","ï¼ï¼ãƒ»ï¼ï¼"], //ã‚ï¼0
                ["ã„","ãƒ»ï¼"], //ã„ï¼1
                ["ã†","ãƒ»ãƒ»ï¼"], //ã†ï¼2
                ["ãˆ","ï¼ãƒ»ï¼ï¼ï¼"], //ãˆï¼3
                ["ãŠ","ãƒ»ï¼ãƒ»ãƒ»ãƒ»"], //ãŠï¼4
                ["ã‹","ãƒ»ï¼ãƒ»ãƒ»"], //ã‹ï¼5
                ["ã","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼6
                ["ã","ãƒ»ãƒ»ãƒ»ï¼"], //ãï¼7
                ["ã‘","ï¼ãƒ»ï¼ï¼"], //ã‘ï¼8
                ["ã“","ï¼ï¼ï¼ï¼"], //ã“ï¼9
                ["ã•","ï¼ãƒ»ï¼ãƒ»ï¼"], //ã•ï¼10
                ["ã—","ï¼ï¼ãƒ»ï¼ãƒ»"], //ã—ï¼11
                ["ã™","ï¼ï¼ï¼ãƒ»ï¼"], //ã™ï¼12
                ["ã›","ãƒ»ï¼ï¼ï¼ãƒ»"], //ã›ï¼13
                ["ã","ï¼ï¼ï¼ãƒ»"], //ãï¼14
                ["ãŸ","ï¼ãƒ»"], //ãŸï¼15
                ["ã¡","ãƒ»ãƒ»ï¼ãƒ»"], //ã¡ï¼16
                ["ã¤","ãƒ»ï¼ï¼ãƒ»"], //ã¤ï¼17
                ["ã¦","ãƒ»ï¼ãƒ»ï¼ï¼"], //ã¦ï¼18
                ["ã¨","ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¨ï¼19
                ["ãª","ãƒ»ï¼ãƒ»"], //ãªï¼20
                ["ã«","ï¼ãƒ»ï¼ãƒ»"], //ã«ï¼21
                ["ã¬","ãƒ»ãƒ»ãƒ»ãƒ»"], //ã¬ï¼22
                ["ã­","ï¼ï¼ãƒ»ï¼"], //ã­ï¼23
                ["ã®","ãƒ»ãƒ»ï¼ï¼"], //ã®ï¼24
                ["ã¯","ï¼ãƒ»ãƒ»ãƒ»"], //ã¯ï¼25
                ["ã²","ï¼ï¼ãƒ»ãƒ»ï¼"], //ã²ï¼26
                ["ãµ","ï¼ï¼ãƒ»ãƒ»"], //ãµï¼27
                ["ã¸","ãƒ»"], //ã¸ï¼28
                ["ã»","ï¼ãƒ»ãƒ»"], //ã»ï¼29
                ["ã¾","ï¼ãƒ»ãƒ»ï¼"], //ã¾ï¼30
                ["ã¿","ãƒ»ãƒ»ï¼ãƒ»ï¼"], //ã¿ï¼31
                ["ã‚€","ï¼"], //ã‚€ï¼32
                ["ã‚","ï¼ãƒ»ãƒ»ãƒ»ï¼"], //ã‚ï¼33
                ["ã‚‚","ï¼ãƒ»ãƒ»ï¼ãƒ»"], //ã‚‚ï¼34
                ["ã‚„","ãƒ»ï¼ï¼"], //ã‚„ï¼35
                ["ã‚","ãƒ»ï¼ãƒ»ãƒ»ï¼"], //ã‚ï¼36
                ["ã‚†","ï¼ãƒ»ãƒ»ï¼ï¼"], //ã‚†ï¼37
                ["ã‚‘","ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã‚‘ï¼38
                ["ã‚ˆ","ï¼ï¼"], //ã‚ˆï¼39
                ["ã‚‰","ãƒ»ãƒ»ãƒ»"], //ã‚‰ï¼40
                ["ã‚Š","ï¼ï¼ãƒ»"], //ã‚Šï¼41
                ["ã‚‹","ï¼ãƒ»ï¼ï¼ãƒ»"], //ã‚‹ï¼42
                ["ã‚Œ","ï¼ï¼ï¼"], //ã‚Œï¼43
                ["ã‚","ãƒ»ï¼ãƒ»ï¼"], //ã‚ï¼44
                ["ã‚","ï¼ãƒ»ï¼"], //ã‚ï¼45
                ["ã‚’","ãƒ»ï¼ï¼ï¼"], //ã‚’ï¼46
                ["ã‚“","ãƒ»ï¼ãƒ»ï¼ãƒ»"], //ã‚“ï¼47
                ["ãŒ","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãŒï¼48
                ["ã","ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼49
                ["ã","ãƒ»ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãï¼50
                ["ã’","ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã’ï¼51
                ["ã”","ï¼ï¼ï¼ï¼ï¼ãƒ»ãƒ»"], //ã”ï¼52
                ["ã–","ï¼ãƒ»ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã–ï¼53
                ["ã˜","ï¼ï¼ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã˜ï¼54
                ["ãš","ï¼ï¼ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãšï¼55
                ["ãœ","ãƒ»ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãœï¼56
                ["ã","ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼57
                ["ã ","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã ï¼58
                ["ã¢","ãƒ»ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¢ï¼59
                ["ã¥","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¥ï¼60
                ["ã§","ãƒ»ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã§ï¼61
                ["ã©","ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã©ï¼62
                ["ã°","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã°ï¼63
                ["ã³","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã³ï¼64
                ["ã¶","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¶ï¼65
                ["ã¹","ãƒ»ï¼ãƒ»ãƒ»"], //ã¹ï¼66
                ["ã¼","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¼ï¼67
                ["ã±","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã±ï¼68
                ["ã´","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã´ï¼69
                ["ã·","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã·ï¼70
                ["ãº","ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ãºï¼71
                ["ã½","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã½ï¼72
                ["ãƒ¼","ãƒ»ï¼ï¼ãƒ»ï¼"], //ãƒ¼ ï¼73
                ["ã€","ãƒ»ï¼ãƒ»ï¼ãƒ»ï¼"], //ã€ ï¼74
                ["ã€‚","ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã€‚ ï¼98ã€€æ”¹è¡Œã‚’èª­ç‚¹ã«
                ["(","ï¼ãƒ»ï¼ï¼ãƒ»ï¼"], //( ï¼75
                [")","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»"], //) ï¼76  
                ["0","ï¼ï¼ï¼ï¼ï¼"], //0 ï¼77
                ["1","ãƒ»ï¼ï¼ï¼ï¼"], //1 ï¼78
                ["2","ãƒ»ãƒ»ï¼ï¼ï¼"], //2 ï¼79
                ["3","ãƒ»ãƒ»ãƒ»ï¼ï¼"], //3 ï¼80
                ["4","ãƒ»ãƒ»ãƒ»ãƒ»ï¼"], //4 ï¼81
                ["5","ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»"], //5 ï¼82
                ["6","ï¼ãƒ»ãƒ»ãƒ»ãƒ»"], //6 ï¼83
                ["7","ï¼ï¼ãƒ»ãƒ»ãƒ»"], //7 ï¼84
                ["8","ï¼ï¼ï¼ãƒ»ãƒ»"], //8 ï¼85
                ["9","ï¼ï¼ï¼ï¼ãƒ»"], //9 ï¼86
                //å°æ–‡å­—ã¯å¯¾å¿œã—ã¦ã„ãªã„ã®ã§å¤§æ–‡å­—ã¨åŒã˜
                ["ã","ï¼ï¼ãƒ»ï¼ï¼"], //ãï¼87
                ["ãƒ","ãƒ»ï¼"], //ãƒï¼88
                ["ã…","ãƒ»ãƒ»ï¼"], //ã…ï¼89
                ["ã‡","ï¼ãƒ»ï¼ï¼ï¼"], //ã‡ï¼90
                ["ã‰","ãƒ»ï¼ãƒ»ãƒ»ãƒ»"], //ã‰ï¼91
                ["ã‚ƒ","ãƒ»ï¼ï¼"], //ã‚ƒï¼92
                ["ã‚…","ï¼ãƒ»ãƒ»ï¼ï¼"], //ã‚…ï¼93
                ["ã‚‡","ï¼ï¼"], //ã‚‡ï¼94
                ["ã‚","ï¼ãƒ»ï¼"], //ã‚ï¼95
                ["ã‚›","ãƒ»ãƒ»"],// æ¿ç‚¹ ï¼96
                ["ã‚œ","ãƒ»ãƒ»ï¼ï¼ãƒ»"], //åŠæ¿ç‚¹ ï¼97
                ["\n","ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //æ”¹è¡Œ ï¼98
                ["ã£","ãƒ»ï¼ï¼ãƒ»"], //ã£ï¼99
                ["",""], // åŒºåˆ‡ã‚Šé€£ç¶šã§ã‚‚okã€€-100
                /*ä»¥ä¸‹å…¨è§’ */
                ["ï¼ˆ","ï¼ãƒ»ï¼ï¼ãƒ»ï¼"], //( ï¼101
                ["ï¼‰","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»"], //) ï¼102 
                ["ï¼","ï¼ï¼ï¼ï¼ï¼"], //0 ï¼103
                ["ï¼‘","ãƒ»ï¼ï¼ï¼ï¼"], //1 ï¼104
                ["ï¼’","ãƒ»ãƒ»ï¼ï¼ï¼"], //2 ï¼105
                ["ï¼“","ãƒ»ãƒ»ãƒ»ï¼ï¼"], //3 ï¼106
                ["ï¼”","ãƒ»ãƒ»ãƒ»ãƒ»ï¼"], //4 ï¼107
                ["ï¼•","ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»"], //5 ï¼108
                ["ï¼–","ï¼ãƒ»ãƒ»ãƒ»ãƒ»"], //6 ï¼109
                ["ï¼—","ï¼ï¼ãƒ»ãƒ»ãƒ»"], //7 ï¼110
                ["ï¼˜","ï¼ï¼ï¼ãƒ»ãƒ»"], //8 ï¼111
                ["ï¼™","ï¼ï¼ï¼ï¼ãƒ»"], //9 ï¼112
                /*ã‚«ã‚¿ã‚«ãƒŠ*/
                ["ã‚¢","ï¼ï¼ãƒ»ï¼ï¼"], //ã‚ï¼0
                ["ã‚¤","ãƒ»ï¼"], //ã„ï¼1
                ["ã‚¦","ãƒ»ãƒ»ï¼"], //ã†ï¼2
                ["ã‚¨","ï¼ãƒ»ï¼ï¼ï¼"], //ãˆï¼3
                ["ã‚ª","ãƒ»ï¼ãƒ»ãƒ»ãƒ»"], //ãŠï¼4
                ["ã‚«","ãƒ»ï¼ãƒ»ãƒ»"], //ã‹ï¼5
                ["ã‚­","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼6
                ["ã‚¯","ãƒ»ãƒ»ãƒ»ï¼"], //ãï¼7
                ["ã‚±","ï¼ãƒ»ï¼ï¼"], //ã‘ï¼8
                ["ã‚³","ï¼ï¼ï¼ï¼"], //ã“ï¼9
                ["ã‚µ","ï¼ãƒ»ï¼ãƒ»ï¼"], //ã•ï¼10
                ["ã‚·","ï¼ï¼ãƒ»ï¼ãƒ»"], //ã—ï¼11
                ["ã‚¹","ï¼ï¼ï¼ãƒ»ï¼"], //ã™ï¼12
                ["ã‚»","ãƒ»ï¼ï¼ï¼ãƒ»"], //ã›ï¼13
                ["ã‚½","ï¼ï¼ï¼ãƒ»"], //ãï¼14
                ["ã‚¿","ï¼ãƒ»"], //ãŸï¼15
                ["ãƒ","ãƒ»ãƒ»ï¼ãƒ»"], //ã¡ï¼16
                ["ãƒ„","ãƒ»ï¼ï¼ãƒ»"], //ã¤ï¼17
                ["ãƒ†","ãƒ»ï¼ãƒ»ï¼ï¼"], //ã¦ï¼18
                ["ãƒˆ","ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¨ï¼19
                ["ãƒŠ","ãƒ»ï¼ãƒ»"], //ãªï¼20
                ["ãƒ‹","ï¼ãƒ»ï¼ãƒ»"], //ã«ï¼21
                ["ãƒŒ","ãƒ»ãƒ»ãƒ»ãƒ»"], //ã¬ï¼22
                ["ãƒ","ï¼ï¼ãƒ»ï¼"], //ã­ï¼23
                ["ãƒ","ãƒ»ãƒ»ï¼ï¼"], //ã®ï¼24
                ["ãƒ","ï¼ãƒ»ãƒ»ãƒ»"], //ã¯ï¼25
                ["ãƒ’","ï¼ï¼ãƒ»ãƒ»ï¼"], //ã²ï¼26
                ["ãƒ•","ï¼ï¼ãƒ»ãƒ»"], //ãµï¼27
                ["ãƒ˜","ãƒ»"], //ã¸ï¼28
                ["ãƒ›","ï¼ãƒ»ãƒ»"], //ã»ï¼29
                ["ãƒ","ï¼ãƒ»ãƒ»ï¼"], //ã¾ï¼30
                ["ãƒŸ","ãƒ»ãƒ»ï¼ãƒ»ï¼"], //ã¿ï¼31
                ["ãƒ ","ï¼"], //ã‚€ï¼32
                ["ãƒ¡","ï¼ãƒ»ãƒ»ãƒ»ï¼"], //ã‚ï¼33
                ["ãƒ¢","ï¼ãƒ»ãƒ»ï¼ãƒ»"], //ã‚‚ï¼34
                ["ãƒ¤","ãƒ»ï¼ï¼"], //ã‚„ï¼35
                ["ãƒ°","ãƒ»ï¼ãƒ»ãƒ»ï¼"], //ã‚ï¼36
                ["ãƒ¦","ï¼ãƒ»ãƒ»ï¼ï¼"], //ã‚†ï¼37
                ["ãƒ±","ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã‚‘ï¼38
                ["ãƒ¨","ï¼ï¼"], //ã‚ˆï¼39
                ["ãƒ©","ãƒ»ãƒ»ãƒ»"], //ã‚‰ï¼40
                ["ãƒª","ï¼ï¼ãƒ»"], //ã‚Šï¼41
                ["ãƒ«","ï¼ãƒ»ï¼ï¼ãƒ»"], //ã‚‹ï¼42
                ["ãƒ¬","ï¼ï¼ï¼"], //ã‚Œï¼43
                ["ãƒ­","ãƒ»ï¼ãƒ»ï¼"], //ã‚ï¼44
                ["ãƒ¯","ï¼ãƒ»ï¼"], //ã‚ï¼45
                ["ãƒ²","ãƒ»ï¼ï¼ï¼"], //ã‚’ï¼46
                ["ãƒ³","ãƒ»ï¼ãƒ»ï¼ãƒ»"], //ã‚“ï¼47
                ["ã‚¬","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãŒï¼48
                ["ã‚®","ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼49
                ["ã‚°","ãƒ»ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãï¼50
                ["ã‚²","ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã’ï¼51
                ["ã‚´","ï¼ï¼ï¼ï¼ï¼ãƒ»ãƒ»"], //ã”ï¼52
                ["ã‚¶","ï¼ãƒ»ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã–ï¼53
                ["ã‚¸","ï¼ï¼ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã˜ï¼54
                ["ã‚º","ï¼ï¼ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãšï¼55
                ["ã‚¼","ãƒ»ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãœï¼56
                ["ã‚¾","ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼57
                ["ãƒ€","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã ï¼58
                ["ãƒ‚","ãƒ»ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¢ï¼59
                ["ãƒ…","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¥ï¼60
                ["ãƒ‡","ãƒ»ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã§ï¼61
                ["ãƒ‰","ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã©ï¼62
                ["ãƒ","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã°ï¼63
                ["ãƒ“","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã³ï¼64
                ["ãƒ–","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¶ï¼65
                ["ãƒ™","ãƒ»ï¼ãƒ»ãƒ»"], //ã¹ï¼66
                ["ãƒœ","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¼ï¼67
                ["ãƒ‘","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã±ï¼68
                ["ãƒ”","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã´ï¼69
                ["ãƒ—","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã·ï¼70
                ["ãƒš","ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ãºï¼71
                ["ãƒ","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"] //ã½ï¼72
                ["ï½±","ï¼ï¼ãƒ»ï¼ï¼"], //ã‚ï¼0
                ["ï½²","ãƒ»ï¼"], //ã„ï¼1
                ["ï½³","ãƒ»ãƒ»ï¼"], //ã†ï¼2
                ["ï½´","ï¼ãƒ»ï¼ï¼ï¼"], //ãˆï¼3
                ["ï½µ","ãƒ»ï¼ãƒ»ãƒ»ãƒ»"], //ãŠï¼4
                ["ï½¶","ãƒ»ï¼ãƒ»ãƒ»"], //ã‹ï¼5
                ["ï½·","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼6
                ["ï½¸","ãƒ»ãƒ»ãƒ»ï¼"], //ãï¼7
                ["ï½¹","ï¼ãƒ»ï¼ï¼"], //ã‘ï¼8
                ["ï½º","ï¼ï¼ï¼ï¼"], //ã“ï¼9
                ["ï½»","ï¼ãƒ»ï¼ãƒ»ï¼"], //ã•ï¼10
                ["ï½¼","ï¼ï¼ãƒ»ï¼ãƒ»"], //ã—ï¼11
                ["ï½½","ï¼ï¼ï¼ãƒ»ï¼"], //ã™ï¼12
                ["ï½¾","ãƒ»ï¼ï¼ï¼ãƒ»"], //ã›ï¼13
                ["ï½¿","ï¼ï¼ï¼ãƒ»"], //ãï¼14
                ["ï¾€","ï¼ãƒ»"], //ãŸï¼15
                ["ï¾","ãƒ»ãƒ»ï¼ãƒ»"], //ã¡ï¼16
                ["ï¾‚","ãƒ»ï¼ï¼ãƒ»"], //ã¤ï¼17
                ["ï¾ƒ","ãƒ»ï¼ãƒ»ï¼ï¼"], //ã¦ï¼18
                ["ï¾„","ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¨ï¼19
                ["ï¾…","ãƒ»ï¼ãƒ»"], //ãªï¼20
                ["ï¾†","ï¼ãƒ»ï¼ãƒ»"], //ã«ï¼21
                ["ï¾‡","ãƒ»ãƒ»ãƒ»ãƒ»"], //ã¬ï¼22
                ["ï¾ˆ","ï¼ï¼ãƒ»ï¼"], //ã­ï¼23
                ["ï¾‰","ãƒ»ãƒ»ï¼ï¼"], //ã®ï¼24
                ["ï¾Š","ï¼ãƒ»ãƒ»ãƒ»"], //ã¯ï¼25
                ["ï¾‹","ï¼ï¼ãƒ»ãƒ»ï¼"], //ã²ï¼26
                ["ï¾Œ","ï¼ï¼ãƒ»ãƒ»"], //ãµï¼27
                ["ï¾","ãƒ»"], //ã¸ï¼28
                ["ï¾","ï¼ãƒ»ãƒ»"], //ã»ï¼29
                ["ï¾","ï¼ãƒ»ãƒ»ï¼"], //ã¾ï¼30
                ["ï¾","ãƒ»ãƒ»ï¼ãƒ»ï¼"], //ã¿ï¼31
                ["ï¾‘","ï¼"], //ã‚€ï¼32
                ["ï¾’","ï¼ãƒ»ãƒ»ãƒ»ï¼"], //ã‚ï¼33
                ["ï¾“","ï¼ãƒ»ãƒ»ï¼ãƒ»"], //ã‚‚ï¼34
                ["ï¾”","ãƒ»ï¼ï¼"], //ã‚„ï¼35
                ["ï¾•","ï¼ãƒ»ãƒ»ï¼ï¼"], //ã‚†ï¼37
                ["ï¾–","ï¼ï¼"], //ã‚ˆï¼39
                ["ï¾—","ãƒ»ãƒ»ãƒ»"], //ã‚‰ï¼40
                ["ï¾˜","ï¼ï¼ãƒ»"], //ã‚Šï¼41
                ["ï¾™","ï¼ãƒ»ï¼ï¼ãƒ»"], //ã‚‹ï¼42
                ["ï¾š","ï¼ï¼ï¼"], //ã‚Œï¼43
                ["ï¾›","ãƒ»ï¼ãƒ»ï¼"], //ã‚ï¼44
                ["ï¾œ","ï¼ãƒ»ï¼"], //ã‚ï¼45
                ["ï½¦","ãƒ»ï¼ï¼ï¼"], //ã‚’ï¼46
                ["ï¾","ãƒ»ï¼ãƒ»ï¼ãƒ»"], //ã‚“ï¼47
                ["ï½¶ï¾","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãŒï¼48
                ["ï½·ï¾","ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼49
                ["ï½¸ï¾","ãƒ»ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãï¼50
                ["ï½¹ï¾","ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã’ï¼51
                ["ï½ºï¾","ï¼ï¼ï¼ï¼ï¼ãƒ»ãƒ»"], //ã”ï¼52
                ["ï½»ï¾","ï¼ãƒ»ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã–ï¼53
                ["ï½¼ï¾","ï¼ï¼ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã˜ï¼54
                ["ï½½ï¾","ï¼ï¼ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ãšï¼55
                ["ï½¾ï¾","ãƒ»ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãœï¼56
                ["ï½¿ï¾","ï¼ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ãï¼57
                ["ï¾€ï¾","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã ï¼58
                ["ï¾ï¾","ãƒ»ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¢ï¼59
                ["ï¾‚ï¾","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã¥ï¼60
                ["ï¾ƒï¾","ãƒ»ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //ã§ï¼61
                ["ï¾„ï¾","ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã©ï¼62
                ["ï¾Šï¾","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã°ï¼63
                ["ï¾‹ï¾","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"], //ã³ï¼64
                ["ï¾Œï¾","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¶ï¼65
                ["ï¾ï¾","ãƒ»ï¼ãƒ»ãƒ»"], //ã¹ï¼66
                ["ï¾ï¾","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //ã¼ï¼67
                ["ï¾Šï¾Ÿ","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã±ï¼68
                ["ï¾‹ï¾Ÿ","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã´ï¼69
                ["ï¾Œï¾Ÿ","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã·ï¼70
                ["ï¾ï¾Ÿ","ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ãºï¼71
                ["ï¾ï¾Ÿ","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼ï¼ãƒ»"], //ã½ï¼72
        ];

         const rome = [
            ["A","ãƒ»ï¼"],
            ["B","ï¼ãƒ»ãƒ»ãƒ»"],
            ["C","ï¼ãƒ»ï¼ãƒ»"],
            ["D","ï¼ãƒ»ãƒ»"],
            ["E","ãƒ»"],
            ["F","ãƒ»ãƒ»ï¼ãƒ»"],
            ["G","ï¼ï¼ãƒ»"],
            ["H","ãƒ»ãƒ»ãƒ»ãƒ»"],
            ["I","ãƒ»ãƒ»"],
            ["J","ãƒ»ï¼ï¼ï¼"],
            ["K","ï¼ãƒ»ï¼"],
            ["L","ãƒ»ï¼ãƒ»ãƒ»"],
            ["M","ï¼ï¼"],
            ["N","ï¼ãƒ»"],
            ["O","ï¼ï¼ï¼"],
            ["P","ãƒ»ï¼ï¼ãƒ»"],
            ["Q","ï¼ï¼ãƒ»ï¼"],
            ["R","ãƒ»ï¼ãƒ»"],
            ["S","ãƒ»ãƒ»ãƒ»"],
            ["T","ï¼"],
            ["U","ãƒ»ãƒ»ï¼"],
            ["V","ãƒ»ãƒ»ãƒ»ï¼"],
            ["W","ãƒ»ï¼ï¼"],
            ["X","ï¼ãƒ»ãƒ»ï¼"],
            ["Y","ï¼ãƒ»ï¼ï¼"],
            ["Z","ï¼ï¼ãƒ»ãƒ»"],
            ["0","ï¼ï¼ï¼ï¼ï¼"], 
            ["1","ãƒ»ï¼ï¼ï¼ï¼"], 
            ["2","ãƒ»ãƒ»ï¼ï¼ï¼"], 
            ["3","ãƒ»ãƒ»ãƒ»ï¼ï¼"],
            ["4","ãƒ»ãƒ»ãƒ»ãƒ»ï¼"], 
            ["5","ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»"], 
            ["6","ï¼ãƒ»ãƒ»ãƒ»ãƒ»"],
            ["7","ï¼ï¼ãƒ»ãƒ»ãƒ»"], 
            ["8","ï¼ï¼ï¼ãƒ»ãƒ»"], 
            ["9","ï¼ï¼ï¼ï¼ãƒ»"], 
            [".","ãƒ»ï¼ãƒ»ï¼ãƒ»ï¼"],
            [",","ï¼ï¼ãƒ»ãƒ»ï¼ï¼"],
            [":","ï¼ï¼ï¼ãƒ»ãƒ»ãƒ»"],
            ["?","ãƒ»ãƒ»ï¼ï¼ãƒ»ãƒ»"],
            ["'","ãƒ»ï¼ï¼ï¼ï¼ãƒ»"],
            ["ï¼","ï¼ãƒ»ãƒ»ãƒ»ãƒ»ï¼"],
            ["(","ï¼ãƒ»ï¼ï¼ãƒ»"],
            [")","ï¼ãƒ»ï¼ï¼ãƒ»ï¼"],
            ["/","ï¼ãƒ»ãƒ»ï¼ãƒ»"],
            ["=","ï¼ãƒ»ãƒ»ãƒ»ï¼"],
            ["+","ãƒ»ï¼ãƒ»ï¼ãƒ»"],
            ['"',"ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»"],
            ["Ã—","ï¼ãƒ»ãƒ»ï¼"],
            ["@","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»"],
            ["a","ãƒ»ï¼"], //å°æ–‡å­—
            ["b","ï¼ãƒ»ãƒ»ãƒ»"],
            ["c","ï¼ãƒ»ï¼ãƒ»"],
            ["d","ï¼ãƒ»ãƒ»"],
            ["e","ãƒ»"],
            ["f","ãƒ»ãƒ»ï¼ãƒ»"],
            ["g","ï¼ï¼ãƒ»"],
            ["h","ãƒ»ãƒ»ãƒ»ãƒ»"],
            ["i","ãƒ»ãƒ»"],
            ["j","ãƒ»ï¼ï¼ï¼"],
            ["k","ï¼ãƒ»ï¼"],
            ["l","ãƒ»ï¼ãƒ»ãƒ»"],
            ["m","ï¼ï¼"],
            ["n","ï¼ãƒ»"],
            ["o","ï¼ï¼ï¼"],
            ["p","ãƒ»ï¼ï¼ãƒ»"],
            ["q","ï¼ï¼ãƒ»ï¼"],
            ["r","ãƒ»ï¼ãƒ»"],
            ["s","ãƒ»ãƒ»ãƒ»"],
            ["t","ï¼"],
            ["u","ãƒ»ãƒ»ï¼"],
            ["v","ãƒ»ãƒ»ãƒ»ï¼"],
            ["w","ãƒ»ï¼ï¼"],
            ["x","ï¼ãƒ»ãƒ»ï¼"],
            ["y","ï¼ãƒ»ï¼ï¼"],
            ["z","ï¼ï¼ãƒ»ãƒ»"],
            ["ï¼¡","ãƒ»ï¼"], //å…¨è§’
            ["ï¼¢","ï¼ãƒ»ãƒ»ãƒ»"],
            ["ï¼£","ï¼ãƒ»ï¼ãƒ»"],
            ["ï¼¤","ï¼ãƒ»ãƒ»"],
            ["ï¼¥","ãƒ»"],
            ["ï¼¦","ãƒ»ãƒ»ï¼ãƒ»"],
            ["ï¼§","ï¼ï¼ãƒ»"],
            ["ï¼¨","ãƒ»ãƒ»ãƒ»ãƒ»"],
            ["ï¼©","ãƒ»ãƒ»"],
            ["ï¼ª","ãƒ»ï¼ï¼ï¼"],
            ["ï¼«","ï¼ãƒ»ï¼"],
            ["ï¼¬","ãƒ»ï¼ãƒ»ãƒ»"],
            ["ï¼­","ï¼ï¼"],
            ["ï¼®","ï¼ãƒ»"],
            ["ï¼¯","ï¼ï¼ï¼"],
            ["ï¼°","ãƒ»ï¼ï¼ãƒ»"],
            ["ï¼±","ï¼ï¼ãƒ»ï¼"],
            ["ï¼²","ãƒ»ï¼ãƒ»"],
            ["ï¼³","ãƒ»ãƒ»ãƒ»"],
            ["ï¼´","ï¼"],
            ["ï¼µ","ãƒ»ãƒ»ï¼"],
            ["ï¼¶","ãƒ»ãƒ»ãƒ»ï¼"],
            ["ï¼·","ãƒ»ï¼ï¼"],
            ["ï¼¸","ï¼ãƒ»ãƒ»ï¼"],
            ["ï¼¹","ï¼ãƒ»ï¼ï¼"],
            ["ï¼º","ï¼ï¼ãƒ»ãƒ»"],
            ["ï½","ãƒ»ï¼"], //å…¨è§’å°æ–‡å­—
            ["ï½‚","ï¼ãƒ»ãƒ»ãƒ»"],
            ["ï½ƒ","ï¼ãƒ»ï¼ãƒ»"],
            ["ï½„","ï¼ãƒ»ãƒ»"],
            ["ï½…","ãƒ»"],
            ["ï½†","ãƒ»ãƒ»ï¼ãƒ»"],
            ["ï½‡","ï¼ï¼ãƒ»"],
            ["ï½ˆ","ãƒ»ãƒ»ãƒ»ãƒ»"],
            ["ï½‰","ãƒ»ãƒ»"],
            ["ï½Š","ãƒ»ï¼ï¼ï¼"],
            ["ï½‹","ï¼ãƒ»ï¼"],
            ["ï½Œ","ãƒ»ï¼ãƒ»ãƒ»"],
            ["ï½","ï¼ï¼"],
            ["ï½","ï¼ãƒ»"],
            ["ï½","ï¼ï¼ï¼"],
            ["ï½","ãƒ»ï¼ï¼ãƒ»"],
            ["ï½‘","ï¼ï¼ãƒ»ï¼"],
            ["ï½’","ãƒ»ï¼ãƒ»"],
            ["ï½“","ãƒ»ãƒ»ãƒ»"],
            ["ï½”","ï¼"],
            ["ï½•","ãƒ»ãƒ»ï¼"],
            ["ï½–","ãƒ»ãƒ»ãƒ»ï¼"],
            ["ï½—","ãƒ»ï¼ï¼"],
            ["ï½˜","ï¼ãƒ»ãƒ»ï¼"],
            ["ï½™","ï¼ãƒ»ï¼ï¼"],
            ["ï½š","ï¼ï¼ãƒ»ãƒ»"],
            ["ï¼ˆ","ï¼ãƒ»ï¼ï¼ãƒ»ï¼"], //( ï¼101
            [")","ãƒ»ï¼ãƒ»ãƒ»ï¼ãƒ»"], //) ï¼102 
            ["ï¼","ï¼ï¼ï¼ï¼ï¼"], //0 ï¼103
            ["ï¼‘","ãƒ»ï¼ï¼ï¼ï¼"], //1 ï¼104
            ["ï¼’","ãƒ»ãƒ»ï¼ï¼ï¼"], //2 ï¼105
            ["ï¼“","ãƒ»ãƒ»ãƒ»ï¼ï¼"], //3 ï¼106
            ["ï¼”","ãƒ»ãƒ»ãƒ»ãƒ»ï¼"], //4 ï¼107
            ["ï¼•","ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»"], //5 ï¼108
            ["ï¼–","ï¼ãƒ»ãƒ»ãƒ»ãƒ»"], //6 ï¼109
            ["ï¼—","ï¼ï¼ãƒ»ãƒ»ãƒ»"], //7 ï¼110
            ["ï¼˜","ï¼ï¼ï¼ãƒ»ãƒ»"], //8 ï¼111
            ["ï¼™","ï¼ï¼ï¼ï¼ãƒ»"], //9 ï¼112
                ["ã‚","ãƒ»ï¼"], //aï¼0
                ["ã„","ãƒ»ãƒ»"], //iï¼1
                ["ã†","ãƒ»ãƒ»ï¼"], //uï¼2
                ["ãˆ","ãƒ»"], //eï¼3
                ["ãŠ","ï¼ï¼ï¼"], //oï¼4
                ["ã‹","ï¼ãƒ»ï¼ï¼ãƒ»ï¼"], //kaï¼5
                ["ã","ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»"], //kiï¼6
                ["ã","ï¼ãƒ»ï¼ï¼ãƒ»ãƒ»ï¼"], //kuï¼7
                ["ã‘","ï¼ãƒ»ï¼ï¼ãƒ»"], //keï¼8
                ["ã“","ï¼ãƒ»ï¼ï¼ï¼ï¼ï¼"], //koï¼9
                ["ã•","ãƒ»ãƒ»ãƒ»ï¼ãƒ»ï¼"], //saï¼10
                ["ã—","ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //shiï¼11
                ["ã—","ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //siï¼11
                ["ã™","ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //suï¼12
                ["ã›","ãƒ»ãƒ»ãƒ»ï¼ãƒ»"], //seï¼13
                ["ã","ãƒ»ãƒ»ãƒ»ï¼ï¼ï¼ï¼"], //soï¼14
                ["ãŸ","ï¼ï¼ãƒ»ï¼"], //taï¼15
                ["ã¡","ï¼ãƒ»ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //chiï¼16
                ["ã¡","ï¼ï¼ãƒ»ãƒ»"], //tiï¼16
                ["ã¤","ï¼ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //tsuï¼17
                ["ã¤","ï¼ï¼ãƒ»ãƒ»ï¼"], //tuï¼17
                ["ã¦","ï¼ï¼ãƒ»"], //teï¼18
                ["ã¨","ï¼ï¼ï¼ï¼ï¼"], //toï¼19
                ["ãª","ï¼ãƒ»ï¼ãƒ»ï¼"], //naï¼20
                ["ã«","ï¼ãƒ»ï¼ãƒ»ãƒ»"], //niï¼21
                ["ã¬","ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼"], //nuï¼22
                ["ã­","ï¼ãƒ»ï¼ãƒ»"], //neï¼23
                ["ã®","ï¼ãƒ»ï¼ï¼ï¼ï¼"], //noï¼24
                ["ã¯","ãƒ»ãƒ»ãƒ»ãƒ»ï¼ãƒ»ï¼"], //haï¼25
                ["ã²","ãƒ»ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //hiï¼26
                ["ãµ","ãƒ»ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼"], //fuï¼27
                ["ãµ","ãƒ»ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //huï¼27
                ["ã¸","ãƒ»ãƒ»ãƒ»ãƒ»ï¼ãƒ»"], //heï¼28
                ["ã»","ãƒ»ãƒ»ãƒ»ãƒ»ï¼ï¼ï¼ï¼"], //hoï¼29
                ["ã¾","ï¼ï¼ï¼ãƒ»ï¼"], //maï¼30
                ["ã¿","ï¼ï¼ï¼ãƒ»ãƒ»"], //miï¼31
                ["ã‚€","ï¼ï¼ï¼ãƒ»ãƒ»ï¼"], //muï¼32
                ["ã‚","ï¼ï¼ï¼ãƒ»"], //meï¼33
                ["ã‚‚","ï¼ï¼ï¼ï¼ï¼ï¼"], //moï¼34
                ["ã‚„","ï¼ãƒ»ï¼ï¼ï¼ãƒ»ï¼"], //yaï¼35
                ["ã‚","ãƒ»ï¼ï¼ï¼ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»"], //wyiï¼36
                ["ã‚†","ï¼ãƒ»ï¼ï¼ï¼ãƒ»ãƒ»ï¼"], //yuï¼37
                ["ã‚‘","ãƒ»ï¼ï¼ï¼ï¼ãƒ»ï¼ï¼ï¼ãƒ»"], //wyeï¼38
                ["ã‚ˆ","ï¼ãƒ»ï¼ï¼ï¼ï¼ï¼ï¼"], //yoï¼39
                ["ã‚‰","ãƒ»ï¼ãƒ»ï¼ãƒ»ï¼"], //raï¼40
                ["ã‚Š","ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //riï¼41
                ["ã‚‹","ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼"], //ruï¼42
                ["ã‚Œ","ãƒ»ï¼ãƒ»ï¼ãƒ»"], //reï¼43
                ["ã‚","ãƒ»ï¼ãƒ»ï¼ï¼ï¼ï¼"], //roï¼44
                ["ã‚","ãƒ»ï¼ï¼ï¼ãƒ»ï¼"], //waï¼45
                ["ã‚’","ãƒ»ï¼ï¼ï¼ï¼ï¼ï¼"], //woï¼46
                ["ã‚“","ï¼ãƒ»ï¼ï¼ãƒ»"], //nï¼47
                ["ãŒ","ï¼ï¼ãƒ»ï¼ãƒ»ï¼"], //gaï¼48
                ["ã","ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //giï¼49
                ["ã","ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼"], //guï¼50
                ["ã’","ï¼ï¼ãƒ»ï¼ãƒ»"], //geï¼51
                ["ã”","ï¼ï¼ãƒ»ï¼ï¼ï¼ï¼"], //goï¼52
                ["ã–","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ï¼"], //zaï¼53
                ["ã˜","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //zuï¼54
                ["ãš","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //zuï¼55
                ["ãœ","ï¼ï¼ãƒ»ãƒ»ï¼ãƒ»"], //zeï¼56
                ["ã","ï¼ï¼ãƒ»ãƒ»ï¼ï¼ï¼ï¼"], //zoï¼57
                ["ã ","ï¼ãƒ»ãƒ»ï¼ãƒ»ï¼"], //daï¼58
                ["ã¢","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //diï¼59
                ["ã¥","ï¼ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //duï¼60
                ["ã§","ï¼ãƒ»ãƒ»ï¼ãƒ»"], //deï¼61
                ["ã©","ï¼ãƒ»ãƒ»ï¼ï¼ï¼ï¼"], //doï¼62
                ["ã°","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ï¼"], //baï¼63
                ["ã³","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»"], //biï¼64
                ["ã¶","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»ãƒ»ï¼"], //buï¼65
                ["ã¹","ï¼ãƒ»ãƒ»ãƒ»ï¼ãƒ»"], //beï¼66
                ["ã¼","ï¼ãƒ»ãƒ»ãƒ»ï¼ï¼ï¼ï¼"], //boï¼67
                ["ã±","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ï¼"], //paï¼68
                ["ã´","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»"], //piï¼69
                ["ã·","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»ãƒ»ï¼"], //puï¼70
                ["ãº","ãƒ»ï¼ï¼ãƒ»ï¼ãƒ»"], //peï¼71
                ["ã½","ãƒ»ï¼ï¼ãƒ»ï¼ï¼ï¼ï¼"], //poï¼72
                ["ã€‚","ãƒ»ï¼ãƒ»ï¼ãƒ»ãƒ»"], //ã€‚ ï¼98ã€€æ”¹è¡Œã‚’èª­ç‚¹ã«
        ];

        let iroha_name = [];
        let morse_name = [];
        let quiz_iroha= [];
        let quiz_morse = [];
        let invalidChars = [];
        let speedRatio = 1;
        let SPEED = 0.15; // ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®é€Ÿã•(å‰ã®3å€é…ã„)
        let DIFFICULTY = 'normal'; //æ–‡å­—ã¨æ–‡å­—ã®é–“éš” normalãŒã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒˆ
        let frequency = 880; //ãƒ¢ãƒ¼ãƒ«ã‚¹ã®éŸ³ã®é«˜ã•
        let currentMp3Blob = null; // ä¸€ç•ªæ–°ã—ã„mp3(Binary Large Object)
        const channels = 1; //ãƒãƒ£ãƒ³ãƒãƒ«æ•°
        let volume = 1; //éŸ³ã®å¤§ãã•

        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let currentOscillators = [];


        let current_language = iroha;


        //å…¥åŠ›å…ƒã¨å‡ºåŠ›å…ˆã‚’å¼•æ•°ã«æ¸¡ã™ã¨ã„ã‚ã¯ã‚’ãƒ¢ãƒ¼ãƒ«ã‚¹ã«å¤‰ãˆã¦å‡ºåŠ›ã™ã‚‹
        function ChangeIroha(inputID,outputID){
            quiz_morse = [];
            const getname = document.getElementById(inputID).value;        
            quiz_iroha = getname.split("");
            for(let char of quiz_iroha){
                const found = current_language.find(data => data[0] === char); //æ¢ç´¢
                if(found){
                    quiz_morse.push(found[1]);
                }else{ //æœªå®šç¾©ã®æ–‡å­—ãŒã‚ã£ãŸå ´åˆ
                    quiz_morse.push("ï¼Ÿ")
                }
            }
            let morse = quiz_morse.join('ï¼');
            document.getElementById(outputID).value = morse;
            return morse;
        }


        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®æ¶ˆå»ãŒä¸Šã¨é•ã†
        function ChangeIrohaNAME(inputID,outputID){
            morse_name = []; //åˆæœŸåŒ–
            const getname = document.getElementById(inputID).value;        
            iroha_name = getname.split("");
            for(let char of iroha_name){
                const found = current_language.find(data => data[0] === char); //æ¢ç´¢
                if(found){
                    morse_name.push(found[1]);
                }else{ //æœªå®šç¾©ã®æ–‡å­—ãŒã‚ã£ãŸå ´åˆ
                    morse_name.push("ï¼Ÿ")
                }
            }
            let morse = morse_name.join('ï¼');
            document.getElementById(outputID).value = morse;
            const btn = document.getElementById("downloadBtn");
            btn.style.display = "none";
            return morse;
        }

        //ã„ã‚ã¯ã‚’ç›´æ¥å…¥ã‚Œã‚‹ã¨å¯¾å¿œã™ã‚‹ãƒ¢ãƒ¼ãƒ«ã‚¹ã‚’è¿”ã™
        function DirectChangeIroha(IROHA){
             quiz_morse = []; //åˆæœŸåŒ–
             IROHA = IROHA.split("");
              for(let char of IROHA){
                const found = current_language.find(data => data[0] === char); //æ¢ç´¢
                if(found){
                    quiz_morse.push(found[1]);
                }else{ //æœªå®šç¾©ã®æ–‡å­—ãŒã‚ã£ãŸå ´åˆ
                    quiz_morse.push("ï¼Ÿ");
                }
            }
            let morse = quiz_morse.join('ï¼');
            return morse;
        }

        // 2æ–‡å­—åˆ¤å®šã®æ¿ç‚¹ã‚„åŠæ¿ç‚¹ã®ã¤ã„ãŸæ–‡å­—ã‚’1æ–‡å­—ã«
        function Conversion(array){
            array = array.split("ã‹ã‚›").join('ãŒ');
            array = array.split("ãã‚›").join('ã');
            array = array.split("ãã‚›").join('ã');
            array = array.split("ã‘ã‚›").join('ã’');
            array = array.split("ã“ã‚›").join('ã”');
            array = array.split("ã•ã‚›").join('ã–');
            array = array.split("ã—ã‚›").join('ã˜');
            array = array.split("ã™ã‚›").join('ãš');
            array = array.split("ã›ã‚›").join('ãœ');
            array = array.split("ãã‚›").join('ã');
            array = array.split("ãŸã‚›").join('ã ');
            array = array.split("ã¡ã‚›").join('ã¢');
            array = array.split("ã¤ã‚›").join('ã¥');
            array = array.split("ã¦ã‚›").join('ã§');
            array = array.split("ã¨ã‚›").join('ã©');
            array = array.split("ã¯ã‚›").join('ã°');
            array = array.split("ã²ã‚›").join('ã³');
            array = array.split("ãµã‚›").join('ã¶');
            array = array.split("ã¸ã‚›").join('ã¹');
            array = array.split("ã»ã‚›").join('ã¼');
            array = array.split("ã¯ã‚œ").join('ã±');
            array = array.split("ã²ã‚œ").join('ã´');
            array = array.split("ãµã‚œ").join('ã·');
            array = array.split("ã¸ã‚œ").join('ãº');
            array = array.split("ã»ã‚œ").join('ã½');
            return array;
        }

        // ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®å†ç”Ÿ
        function playMorse(id){
            let morse =[];
            if(id == 'NAME'){morse = morse_name.join('ï¼');}
            else{morse = document.getElementById(id).value;}

            // å‰å›ã®éŸ³ã‚’æ­¢ã‚ã‚‹
            currentOscillators.forEach(osc => {
                try { osc.stop(); } catch (e) {}
            });
            currentOscillators = [];

            // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆéŸ³ãŒé€”ä¸­ã§æ®‹ã‚‰ãªã„ã‚ˆã†ã«ï¼‰
            audioCtx.close();

            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const dot = SPEED * speedRatio; 
            let time = audioCtx.currentTime; // å†ç”Ÿé–‹å§‹æ™‚åˆ»

            animateMorseFlow(morse);

            for(let char of morse){
                if(char === "ãƒ»"){
                    ring(audioCtx, time, dot);
                    time += dot + dot; // ã€Œãƒ»ã€ + ã€Œç©ºç™½ã€ ((1ç‚¹ + 1ç‚¹
                } else if(char === "ï¼" || char === "-"){
                    ring(audioCtx, time, dot * 3);
                    time += dot * 3 + dot; // ã€Œï¼ã€ + ã€Œç©ºç™½ã€ ((3ç‚¹ + 1ç‚¹
                } else if(char === "ï¼" && DIFFICULTY === 'normal'){
                    time += dot * 2; // æ–‡å­—ã¨æ–‡å­—ã®é–“ 3ç‚¹(ä¸Šã®ç©ºç™½åˆ† + 2ç‚¹)
                } else if(char === "ï¼" && DIFFICULTY === 'easy'){
                    time += dot * 5; // æ–‡å­—ã¨æ–‡å­—ã®é–“ 6ç‚¹(ä¸Šã®ç©ºç™½åˆ† + 5ç‚¹)
                } else if(char === "ï¼Ÿ"){ //  ?ã®å‡¦ç†ã©ã†ã—ã‚ˆã†
                    time += dot ;
                }
            }
        }

        //ãƒ“ãƒ¼ãƒ—éŸ³ã‚’é³´ã‚‰ã™(èãã¨ãç”¨)
        function ring(ctx, start, duration){
            const oscillator = ctx.createOscillator();
            const gainNode = ctx.createGain();
            oscillator.type = "sine";
            // éŸ³é‡ã®è¨­å®š
            oscillator.frequency.setValueAtTime(frequency, start);
            gainNode.gain.setValueAtTime(volume, start); //éŸ³é‡volumeã§ã‚¹ã‚¿ãƒ¼ãƒˆ
            gainNode.gain.setValueAtTime(0, start + duration); //durationåˆ†ãŸã£ãŸã‚‰0ã«ã™ã‚‹ 
            // éŸ³ã®è¨­å®š
            oscillator.connect(gainNode).connect(ctx.destination); //éŸ³é‡èª¿æ•´->ã‚¹ãƒ”ãƒ¼ã‚«ã«æ¥ç¶š
            oscillator.start(start); //startæ™‚ã«å§‹ã‚ã‚‹
            oscillator.stop(start + duration);//durationçµŒéã§çµ‚äº†

            currentOscillators.push(oscillator); //ç¾åœ¨ã®ã‚‚ã®ã‚’è¨˜éŒ²
        }

        //ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®æ›¸ã‹ã‚Œã¦ã„ã‚‹å ´æ‰€ã‚’æŒ‡å®šã™ã‚‹ã¨ã„ã‚ã¯ã«å¤‰æ›´
        function ChangeMorse(inputID){
            const morseInput = document.getElementById(inputID).value;
            const getMorse = morseInput.split("ï¼");
            let result = "";
            invalidChars = [];
            for(let code of getMorse){
                const found = current_language.find(data => data[1] === code);
                if(found){
                    result += found[0];
                }else{
                    result += "ï¼Ÿ";
                    invalidChars.push(code);
                }
            }
            result = Conversion(result);
            if(morseInput === morse_name.join('ï¼')){
                showFloatingResult(result,1,invalidChars);
            }
            else{
                showFloatingResult(result,0,invalidChars);
            }
            return result;
        }

        //ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã‚’ç›´æ¥å…¥ã‚Œã‚‹ã¨å¯¾å¿œã™ã‚‹ã„ã‚ã¯ã‚’ã‹ãˆã™
        function DirectChangeMorse(morse){
            const getMorse = morse.split("ï¼");
            let result = "";
            for(let code of getMorse){
                const found = current_language.find(data => data[1] === code);
                if(found){
                    result += found[0];
                }else{
                    result += "ï¼Ÿ";
                }
            }
            return result;
        }



        //é€Ÿã•å¤‰æ›´
        function ChangeSpeed(ratio){
            speedRatio = 1.0 / ratio;
            const btn = document.getElementById("downloadBtn");
            btn.style.display = "none";
        }


        // ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã‚’mp3ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›
        async function morseToMp3(morseString) {
            const sampleRate = 44100; //ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å‘¨æ³¢æ•°
            let unit = SPEED * speedRatio;
            let totalDuration = 0;

            for (let char of morseString) {
                if (char === "ãƒ»"){totalDuration += unit + unit;}
                else if (char === "ï¼"){totalDuration += unit * 3 + unit;}
                else if (char === "ï¼"){totalDuration += unit * 2;}
            }


            const offlineCtx = new OfflineAudioContext(channels, sampleRate * totalDuration, sampleRate);
            let time = 0;

            for (let char of morseString) {
                if (char === "ãƒ»") {
                    addBeep(offlineCtx, time, unit, frequency);
                    time += unit + unit;
                } else if (char === "ï¼") {
                    addBeep(offlineCtx, time, unit * 3, frequency);
                    time += unit * 3 + unit;
                } else if (char === "ï¼") {
                    time += unit * 2;
                }
            }

            const audioBuffer = await offlineCtx.startRendering();
            return audioBufferToMp3(audioBuffer);
        }

        // éŸ³ã‚’ãƒ“ãƒ¼ãƒ—éŸ³ã§é³´ã‚‰ã™(éŒ²éŸ³ç”¨)
        function addBeep(ctx, startTime, duration, frequency) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.frequency.value = frequency;
            osc.type = 'sine';
            osc.connect(gain);
            gain.connect(ctx.destination);
            gain.gain.setValueAtTime(volume, startTime);
            gain.gain.setValueAtTime(0, startTime + duration);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        // AudioBuffer â†’ MP3 ã«å¤‰æ›
        function audioBufferToMp3(audioBuffer) {
            const samples = audioBuffer.getChannelData(0);
            const mp3encoder = new lamejs.Mp3Encoder(channels, audioBuffer.sampleRate, 128);
            const sampleBlockSize = 1152;
            const mp3Data = [];

            for (let i = 0; i < samples.length; i += sampleBlockSize) {
                const sampleChunk = samples.subarray(i, i + sampleBlockSize);
                const int16Samples = new Int16Array(sampleChunk.length);
                for (let j = 0; j < sampleChunk.length; j++) {
                    int16Samples[j] = sampleChunk[j] * 32767;
                }
                const mp3buf = mp3encoder.encodeBuffer(int16Samples);
                if (mp3buf.length > 0) mp3Data.push(mp3buf);
            }

            const mp3buf = mp3encoder.flush();
            if (mp3buf.length > 0) mp3Data.push(mp3buf);

            return new Blob(mp3Data, { type: 'audio/mp3' });
        }

        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }


        //LINEã‹ã©ã†ã‹ã®åˆ¤æ–­
        function isLineBrowser() {
            const ua = navigator.userAgent.toLowerCase();
            return ua.includes("line");
        }

        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        async function generateMorseMp3(id) {
        const morse = document.getElementById(id).value;
            if (!morse.trim()) {
                alert("ä½•ã‚‚å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“");
                return;
            }

            if (isLineBrowser()) {
                alert("LINEã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯MP3ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã€‚\nå³ä¸‹ã®ã€Œâ€¦ã€ã‹ã‚‰ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã€ã¾ãŸã¯Safari/Chromeã§é–‹ã„ã¦ãã ã•ã„ã€‚");
                return;
            }

            const blob = await morseToMp3(morse);
            currentMp3Blob = blob;

            const btn = document.getElementById("downloadBtn");
            btn.style.display = "inline-block";
            btn.onclick = () => {
                let originalText = (typeof iroha_name !== 'undefined' && Array.isArray(iroha_name)) ? iroha_name.join("") : '';
                originalText = originalText.replace(/[\\/:*?"<>|]/g, '_');
                if (originalText.length > 20) originalText = originalText.substring(0, 20) + "ãƒ»ãƒ»ãƒ»";
                const filename = (typeof getDownloadFilename === 'function') ? getDownloadFilename(originalText) : (`ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·_${originalText}.mp3`);
                downloadBlob(currentMp3Blob, filename);
                window.alert(`${(typeof getAlertMessage === 'function') ? getAlertMessage('downloadCompleted','Download completed!') : 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†ï¼'}\nãƒ•ã‚¡ã‚¤ãƒ«å: ${filename}`);
            }

        }

        //éŸ³ã®é«˜ã•ã‚’è¿”ã™ã€€åŸºæœ¬880Hz
        function getFrequency(){
            return frequency;
        }

        //éŸ³ã®å¤§ãã•ã‚’è¨­å®š 0~1
        function setVolume(newVolume){ 
            volume = Math.pow(newVolume, 2); //éŸ³é‡ã‚’2ä¹—ã—ã¦å°ã•ã„éŸ³ã‚‚èã“ãˆã‚‹ã‚ˆã†ã«
        }

        //éŸ³ã®é«˜ã•ã‚’è¨­å®š
        function setFrequency(newFrequency){ 
            frequency = newFrequency;
        }
                
        function appendText(char,id) {
            const textbox = document.getElementById(id);
            if(!textbox) return;
            // Insert at caret position (replace selection if any)
            const start = textbox.selectionStart || 0;
            const end = textbox.selectionEnd || 0;
            const before = textbox.value.slice(0, start);
            const after = textbox.value.slice(end);
            textbox.value = before + char + after;
            const newPos = before.length + char.length;
            textbox.selectionStart = textbox.selectionEnd = newPos;
            textbox.focus();
        }

        function deleteLast(id) {
            const textbox = document.getElementById(id);
            if(!textbox) return;
            const start = textbox.selectionStart || 0;
            const end = textbox.selectionEnd || 0;
            if(start !== end){
                // Delete selected range
                const before = textbox.value.slice(0, start);
                const after = textbox.value.slice(end);
                textbox.value = before + after;
                textbox.selectionStart = textbox.selectionEnd = start;
            } else {
                // delete one char before caret
                const deleteStart = Math.max(0, start - 1);
                const before = textbox.value.slice(0, deleteStart);
                const after = textbox.value.slice(end);
                textbox.value = before + after;
                const newPos = deleteStart;
                textbox.selectionStart = textbox.selectionEnd = newPos;
            }
            textbox.focus();
        }

    function clearText(id) {
      const textbox = document.getElementById(id);
      textbox.value = '';
    }


// ========================
// ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
// ========================

const DELAY_RATIO = 0.5; // 0.5å€ã«è©°ã‚ã‚‹

function setMorseEndPosition(value) {
  document.documentElement.style.setProperty('--morse-end-position', value);
}

function animateMorseFlow(morseStr) {
  const flow = document.getElementById('morseFlow');
  flow.innerHTML = '';
  let baseDelay = 0;
  const dot = SPEED;

  const flowWidth = flow.offsetWidth; // flowé ˜åŸŸã®pxå¹…
  const endMargin = 8000; // è¿½åŠ è·é›¢(px) ã´Ã—20ã«å¯¾å¿œ
  const totalDistance = flowWidth + endMargin;

    const flowSpeed = 125 / speedRatio; // ãƒ¢ãƒ¼ãƒ«ã‚¹ã®ã‚¹ãƒ”ãƒ¼ãƒ‰
    const animationDurationSec = totalDistance / flowSpeed;

    setMorseEndPosition(`${-totalDistance}px`);

    let delayRatio = DELAY_RATIO * speedRatio;

    for (let i = 0; i < morseStr.length; i++) {
        const ch = morseStr[i];
        if (!'ãƒ»ï¼ï¼'.includes(ch)) continue;

        const span = document.createElement('span');
        span.className = 'morse-flow-char';
        span.textContent = ch;

        span.style.animationDelay = `${baseDelay * delayRatio}s`;
        span.style.animationDuration = `${animationDurationSec}s`;

        flow.appendChild(span);

        if (ch === "ãƒ»"){baseDelay += dot + dot;}
        else if (ch === "ï¼" || ch === "-"){baseDelay += dot*2 + dot;}
        else if (ch === "ï¼"){baseDelay += dot * 2;}
    }

}

function showFloatingResult(text, isCorrect = false,invalidChars = []){
    const resultDiv = document.getElementById("morseResult");
    const correctDiv = document.getElementById("correctMessage");


    if (!text || text.trim() === "") {
        window.alert(getScriptAlertMessage('emptyMorse', 'Morse code is empty.'));
        return;
    }

    if (text.includes("ï¼Ÿ")){
        const unique = [...new Set(invalidChars)].join("\n");
        window.alert(getScriptAlertMessage('invalidMorse', 'Invalid Morse code detected:') + `${unique}\n`);
        return;
    }

    // å¤‰æ›æ–‡å­—è¡¨ç¤º
    resultDiv.textContent = text;
    resultDiv.classList.remove("morse-float");
    void resultDiv.offsetWidth;
    resultDiv.classList.add("morse-float");

    // æ­£è§£ãƒ»ä¸æ­£è§£è¡¨ç¤º
    correctDiv.classList.remove("correct-float", "incorrect-float");
    void correctDiv.offsetWidth;

    
    if (isCorrect) {
        correctDiv.textContent = "ãŠã‚ã§ã¨ã†ğŸ‰";
        correctDiv.classList.add("correct-float");
        // ãŠã‚ã§ã¨ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
        const next3Btn = document.getElementById('next3');
        if (next3Btn) next3Btn.style.display = 'inline-block';
    } else {
        correctDiv.textContent = ""
    }
}

function showJudgeMark(isCorrect) {
    const judgeMark = document.getElementById("judgeMark");

    // ä¸€æ—¦ class ã‚’å‰Šé™¤ã—ã¦å¼·åˆ¶çš„ã«åˆæœŸåŒ–
    judgeMark.classList.remove("judge-correct", "judge-incorrect");

    // å¼·åˆ¶å†æç”»
    void judgeMark.offsetWidth;

    // åˆ¤å®šãƒãƒ¼ã‚¯ã®å†…å®¹ã¨ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
    judgeMark.textContent ="";
    if (isCorrect === 1) {
        judgeMark.textContent = "ã€‡";
        judgeMark.className = "judge-mark judge-correct";
    } else if(isCorrect === 0) {
        judgeMark.textContent = "Ã—";
        judgeMark.className = "judge-mark judge-incorrect";
    }

}

function playDot(){
    currentOscillators.forEach(osc => {
        try { osc.stop(); } catch (e) {}
    });
    currentOscillators = [];
    audioCtx.close();
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const dot = SPEED * speedRatio; 
    let time = audioCtx.currentTime; // å†ç”Ÿé–‹å§‹æ™‚åˆ»
    ring(audioCtx,time,dot);
}

function playDash(){
    currentOscillators.forEach(osc => {
        try { osc.stop(); } catch (e) {}
    });
    currentOscillators = [];
    audioCtx.close();
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const dot = SPEED * speedRatio; 
    let time = audioCtx.currentTime; // å†ç”Ÿé–‹å§‹æ™‚åˆ»
    ring(audioCtx,time,dot*3);
}

// ===== MP3 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»è§£ææ©Ÿèƒ½ =====
// ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã‹ã‚‰è§£æã‚’è¡Œã†
async function analyzeUploadedFile(){
    const input = document.getElementById('audioFile');
    const file = input.files && input.files[0];
    if(!file){
        alert(getScriptAlertMessage('selectFile', 'Please select a file.'));
        return;
    }
    const reader = new FileReader();
    reader.onload = async function(e){
        document.getElementById('analyzeInfo').textContent = 'è§£æä¸­...';
        const arrayBuffer = e.target.result;
        try{
            const morse = await analyzeAudioBuffer(arrayBuffer);
            document.getElementById('analyzedMorse').value = morse;
            document.getElementById('analyzedMorseToIroha').value = Conversion(showDecodedFromAnalyzed());
            document.getElementById('analyzeInfo').textContent = 'è§£æå®Œäº†';
        }catch(err){
            console.error(err);
            alert(getScriptAlertMessage('analysisFailed', 'Analysis failed: ') + err.message);
            document.getElementById('analyzeInfo').textContent = 'è§£æã‚¨ãƒ©ãƒ¼';
        }
    };
    reader.readAsArrayBuffer(file);
}

// ArrayBuffer ã‚’ AudioBuffer ã«ã—ã¦è§£æã™ã‚‹
async function analyzeAudioBuffer(arrayBuffer){
    // decode
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const audioBuffer = await ctx.decodeAudioData(arrayBuffer);
    const sampleRate = audioBuffer.sampleRate;
    const channelData = audioBuffer.getChannelData(0);

    // envelope ã‚’ä½œæˆ (5ms window)
    const windowMs = 5; // ms
    const windowSize = Math.max(1, Math.floor(sampleRate * (windowMs/1000)));
    const envelope = [];
    let maxEnv = 0;
    for(let i = 0; i < channelData.length; i += windowSize){
        let sum = 0;
        let end = Math.min(i + windowSize, channelData.length);
        for(let j = i; j < end; j++){
            sum += Math.abs(channelData[j]);
        }
        let rms = sum / (end - i);
        envelope.push(rms);
        if(rms > maxEnv) maxEnv = rms;
    }

    // threshold ã‚’è‡ªå‹•æ±ºå®šï¼ˆãƒã‚¤ã‚ºã®å‰²åˆã‚’è€ƒæ…®ï¼‰
    const sorted = Array.from(envelope).sort((a,b)=>a-b);
    const noiseLevel = sorted[Math.floor(sorted.length * 0.25)] || 0; // 25%ç‚¹
    const signalLevel = sorted[Math.floor(sorted.length * 0.98)] || maxEnv; // 98%ç‚¹
    // threshold ã‚’ noise ã¨ signal ã®ä¸­é–“çš„ãªå€¤ã«è¨­å®š
    let threshold = Math.max(noiseLevel + (signalLevel - noiseLevel) * 0.25, maxEnv * 0.06);

    // binary ã‚ªãƒ³/ã‚ªãƒ•é…åˆ—
    const onOff = envelope.map(v => v >= threshold ? 1 : 0);

    // segment åŒ–ã—ã¦æ™‚é–“ã‚’æ¸¬ã‚‹
    const segments = []; // {isOn: boolean, frames: n}
    let current = onOff[0];
    let count = 1;
    for(let i = 1; i < onOff.length; i++){
        if(onOff[i] === current){ count++; }
        else{ segments.push({isOn: !!current, frames: count}); current = onOff[i]; count = 1; }
    }
    segments.push({isOn: !!current, frames: count});

    // ãƒ•ãƒ¬ãƒ¼ãƒ  -> sec
    const unitSec = windowSize / sampleRate; // sec per envelope frame
    const toneDurations = segments.filter(s => s.isOn).map(s => s.frames * unitSec);
    const silenceDurations = segments.filter(s => !s.isOn).map(s => s.frames * unitSec);

    if(toneDurations.length === 0){
        throw new Error('éŸ³ãŒæ¤œå‡ºã§ãã¾ã›ã‚“ã§ã—ãŸ');
    }

    // dotUnit ã®æ¨å®š: çŸ­ã„ãƒˆãƒ¼ãƒ³ã®ä¸­å¤®å€¤
    const sortedTones = toneDurations.slice().sort((a,b)=>a-b);
    const cutoff = Math.max(1, Math.floor(sortedTones.length * 0.3));
    const shortestSlice = sortedTones.slice(0, cutoff);
    const dotUnit = median(shortestSlice);

    // æ§‹ç¯‰ï¼šãƒ¢ãƒ¼ãƒ«ã‚¹è¡¨è¨˜(ãƒ»,ï¼,ï¼)
    let morseStr = '';
    for(let i = 0; i < segments.length; i++){
        const seg = segments[i];
        if(seg.isOn){
            const dur = seg.frames * unitSec;
            if(dur <= dotUnit * 1.8){ morseStr += 'ãƒ»'; }
            else{ morseStr += 'ï¼'; }
        }else{
            const dur = seg.frames * unitSec;
            // silence åˆ¤å®š
            if(dur > dotUnit * 5){ // wordé–“
                morseStr += 'ï¼'; // åŒºåˆ‡ã‚Šæ–‡å­—
            }else if(dur > dotUnit * 2.5){ // letteré–“
                morseStr += 'ï¼';
            }else{
                // ãªã«ã‚‚ã—ãªã„
            }
        }
    }

    // é€£ç¶šã®åŒºåˆ‡ã‚Šã‚’1ã¤ã«
    morseStr = morseStr.replace(/ï¼+/g,'ï¼');
    // å…ˆé ­æœ«å°¾ã®ä¸è¦åŒºåˆ‡ã‚Šã‚’é™¤å»
    morseStr = morseStr.replace(/(^ï¼+|ï¼+$)/g,'');
    return morseStr;
}

// median helper
function median(arr){
    if(arr.length === 0) return 0;
    const s = arr.slice().sort((a,b)=>a-b);
    const mid = Math.floor(s.length/2);
    if(s.length % 2 === 0) return (s[mid-1] + s[mid]) / 2;
    return s[mid];
}

// ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ¢ãƒ¼ãƒ«ã‚¹ã‚’å…ƒã«æ–‡å­—ã«å¤‰æ›ã—ã¦è¡¨ç¤º
function showDecodedFromAnalyzed(){
    const morseStr = document.getElementById('analyzedMorse').value;
    if(!morseStr || morseStr.trim() === ''){
        alert(getScriptAlertMessage('noAnalysisResult', 'No analysis result.'));
        return;
    }
    const decoded = DirectChangeMorse(morseStr);
    if(decoded){
        return decoded;
    }
}

// ãƒ­ãƒ¼ãƒå­—æ–‡å­—åˆ—ã‚’ã²ã‚‰ãŒãªã«å¤‰æ›ã™ã‚‹
function romajiToHiragana(input){
    if(!input) return '';
    let s = input.toLowerCase();
    // åŒºåˆ‡ã‚Šæ–‡å­—ã‚’ãªãã™
    s = s.replace(/[^a-z0-9\-\/\s]/g, '');
    const map = {
        "kya":"ãã‚ƒ","kyu":"ãã‚…","kyo":"ãã‚‡",
        "gya":"ãã‚ƒ","gyu":"ãã‚…","gyo":"ãã‚‡",
        "sha":"ã—ã‚ƒ","shu":"ã—ã‚…","sho":"ã—ã‚‡",
        "ja":"ã˜ã‚ƒ","ju":"ã˜ã‚…","jo":"ã˜ã‚‡",
        "cha":"ã¡ã‚ƒ","chu":"ã¡ã‚…","cho":"ã¡ã‚‡",
        "nya":"ã«ã‚ƒ","nyu":"ã«ã‚…","nyo":"ã«ã‚‡",
        "hya":"ã²ã‚ƒ","hyu":"ã²ã‚…","hyo":"ã²ã‚‡",
        "bya":"ã³ã‚ƒ","byu":"ã³ã‚…","byo":"ã³ã‚‡",
        "pya":"ã´ã‚ƒ","pyu":"ã´ã‚…","pyo":"ã´ã‚‡",
        "mya":"ã¿ã‚ƒ","myu":"ã¿ã‚…","myo":"ã¿ã‚‡",
        "rya":"ã‚Šã‚ƒ","ryu":"ã‚Šã‚…","ryo":"ã‚Šã‚‡",
        "tsu":"ã¤","shi":"ã—","chi":"ã¡","fu":"ãµ","ji":"ã˜",
        "la":"ã","li":"ãƒ","lu":"ã…","le":"ã‡","lo":"ã‰",
        "xa":"ã","xi":"ãƒ","xu":"ã…","xe":"ã‡","xo":"ã‰",
        "we":"ã‚‘","wi":"ã‚",
        "ca":"ã‹","ci":"ã—","cu":"ã","ce":"ã›","co":"ã“",
        "qa":"ãã","qi":"ããƒ","qu":"ã","qe":"ãã‡","qo":"ãã‰",
        "fa":"ãµã","fi":"ãµãƒ","fe":"ãµã‡","fo":"ãµã‰",
        "va":"ã‚”ã","vi":"ã‚”ãƒ","vu":"ã‚”","ve":"ã‚”ã‡","vo":"ã‚”ã‰",
        "a":"ã‚","i":"ã„","u":"ã†","e":"ãˆ","o":"ãŠ",
        "ka":"ã‹","ki":"ã","ku":"ã","ke":"ã‘","ko":"ã“",
        "ga":"ãŒ","gi":"ã","gu":"ã","ge":"ã’","go":"ã”",
        "sa":"ã•","si":"ã—","su":"ã™","se":"ã›","so":"ã",
        "za":"ã–","zi":"ã˜","zu":"ãš","ze":"ãœ","zo":"ã",
        "ta":"ãŸ","ti":"ã¡","tu":"ã¤","te":"ã¦","to":"ã¨",
        "da":"ã ","di":"ã¢","du":"ã¥","de":"ã§","do":"ã©",
        "na":"ãª","ni":"ã«","nu":"ã¬","ne":"ã­","no":"ã®",
        "ha":"ã¯","hi":"ã²","hu":"ãµ","he":"ã¸","ho":"ã»",
        "ba":"ã°","bi":"ã³","bu":"ã¶","be":"ã¹","bo":"ã¼",
        "pa":"ã±","pi":"ã´","pu":"ã·","pe":"ãº","po":"ã½",
        "ma":"ã¾","mi":"ã¿","mu":"ã‚€","me":"ã‚","mo":"ã‚‚",
        "ya":"ã‚„","yu":"ã‚†","yo":"ã‚ˆ",
        "ra":"ã‚‰","ri":"ã‚Š","ru":"ã‚‹","re":"ã‚Œ","ro":"ã‚",
        "wa":"ã‚","wo":"ã‚’","n":"ã‚“"
    };
    const keys = Object.keys(map).sort((a,b)=>b.length-a.length);
    let out = '';
    const isVowel = ch => /[aeiou]/.test(ch);
    const isConsonant = ch => /[bcdfghjklmnpqrstvwxyz]/.test(ch);

    for(let i=0;i<s.length;){
        // ç‰¹åˆ¥å‡¦ç†: 'nn' => ã‚“
        if(s.startsWith('nn', i)){
            out += 'ã‚“';
            i += 2;
            continue;
        }
        // ã¡ã£ã¡ã‚ƒã„ã€Œã£ã€ã®å‡¦ç†
        if(i+1 < s.length && s[i] === s[i+1] && isConsonant(s[i]) && s[i] !== 'n'){
            out += 'ã£';
            i++;
            continue;
        }

        // ã€Œnã€ã®å‡¦ç†
        if(s[i] === 'n'){
            const next = s[i+1];
            if(!next || !isVowel(next)){
                // æ¬¡ã®æ–‡å­—ãŒæ¯éŸ³ã§ãªã„ -> ã‚“
                out += 'ã‚“';
                i++;
                continue;
            }
            // æ¬¡ã®æ–‡å­—ãŒæ¯éŸ³ãªã‚‰ãªã«ã‚‚ã—ãªã„ï¼ˆæ¬¡ã®ãƒ«ãƒ¼ãƒ—ã§å‡¦ç†ï¼‰
        }

        let matched = false;
        for(const k of keys){
            if(s.startsWith(k, i)){
                out += map[k];
                i += k.length;
                matched = true;
                break;
            }
        }
        if(!matched){
            // ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹æ–‡å­—
            if(s[i] === ' ' || s[i] === '-' || s[i] === '/'){
                out += s[i];
                i++;
            } else {
                // ä¸æ˜ãªæ–‡å­—ã¯ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
                out += s[i];
                i++;
            }
        }
    }
    return out;
}

// è§£æçµæœã®ãƒ­ãƒ¼ãƒå­—ã‚’ã²ã‚‰ãŒãªã«å¤‰æ›ã—ã¦è¡¨ç¤º
function convertRomajiAnalyzedToHiragana(){
    const morseVal = document.getElementById('analyzedMorse').value;
    if(!morseVal || !morseVal.trim()){
        alert(getScriptAlertMessage('noMorseAnalyzed', 'No analyzed Morse code.'));
        return;
    }
    const decoded = showDecodedFromAnalyzed();
    if(!decoded){ alert(getScriptAlertMessage('noDecodedString', 'Failed to get string.')); return; }
    if(!/[a-zA-Z]/.test(decoded)){
        alert(getScriptAlertMessage('noRomajiInResult', 'Analysis result contains no romaji.'));
    }
    const hira = romajiToHiragana(decoded);
    const outEl = document.getElementById('romajiToHiraResult');
    if(outEl) { outEl.value = hira; outEl.style.display = 'block'; }
}


window.addEventListener('DOMContentLoaded', () => {
    const lang = document.getElementById("language"); 
    let mode = "JP";

    if(lang){ // è¦ç´ ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã¯å¿…é ˆ
        lang.addEventListener("change", function (e) {
            changeLanguage(lang.value);
             // lang ãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚ã‚‹ã®ã§ãƒã‚§ãƒƒã‚¯
            if(lang.value === "æ—¥æœ¬èª"){mode = "JP";}
            else if(lang.value === "ãƒ­ãƒ¼ãƒå­—"){mode = "RO";}
            else{mode = "EN";}
        });
    }

    const audioInput = document.getElementById('audioFile');
    if(audioInput){
        audioInput.addEventListener('change', () => {
            // æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚ŒãŸã‚‰è§£æçµæœã‚’ã‚¯ãƒªã‚¢
            const analyzedEl = document.getElementById('analyzedMorse');
            const analyzedToIrohaEl = document.getElementById('analyzedMorseToIroha');
            const romajiResultEl = document.getElementById('romajiToHiraResult');
            if(analyzedEl) analyzedEl.value = '';
            if(analyzedToIrohaEl) analyzedToIrohaEl.value = '';
            if(romajiResultEl) { romajiResultEl.value = ''; romajiResultEl.style.display = 'none'; }
            analyzeUploadedFile();
            document.getElementById('analyzeInfo').textContent = 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¾ã—ãŸã€‚è§£æãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„';
        });
    }

    try {
        const storedLang = localStorage.getItem('ml_language');
        const preferred = storedLang || (lang && lang.value) || 'æ—¥æœ¬èª';
        if (lang) { lang.value = preferred; }
        const globalLang = document.getElementById('globalLanguage');
        if (globalLang) globalLang.value = preferred;
        if (typeof changeLanguage === 'function') changeLanguage(preferred);
    } catch (e) {
        console.warn('Failed to apply stored language', e);
    }
});

function changeLanguage(languageName){
    // Clear analyzed textareas when language changes
    const analyzedEl = document.getElementById('analyzedMorse');
    const analyzedToIrohaEl = document.getElementById('analyzedMorseToIroha');
    const romajiResultEl = document.getElementById('romajiToHiraResult');
    if(analyzedEl) analyzedEl.value = '';
    if(analyzedToIrohaEl) analyzedToIrohaEl.value = '';
    if(romajiResultEl) { romajiResultEl.value = ''; romajiResultEl.style.display = 'none'; }

    if(languageName === "æ—¥æœ¬èª" || languageName === "ãƒ­ãƒ¼ãƒå­—"){
        if(languageName === "æ—¥æœ¬èª" ){current_language = iroha;}
        if(languageName === "ãƒ­ãƒ¼ãƒå­—" ){current_language = rome;}
        console.log("æ—¥æœ¬èªé¸æŠ\n");
        document.getElementById("h1").innerHTML = "ğŸµ ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ä½“é¨“ã‚¢ãƒ—ãƒª ğŸ“¡";
        document.getElementById("inline-character-balloon").innerHTML = "åƒ•ã¨ä¸€ç·’ã«ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã‚’å­¦ã¼ã†ï¼";
        document.getElementById("welcome-text").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®ä¸–ç•Œã¸ã‚ˆã†ã“ãï¼<br>\
        ã‚ãªãŸã®åå‰ã‚’ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã«å¤‰æ›ã—ãŸã‚Šã€å®Ÿéš›ã«ãƒ¢ãƒ¼ãƒ«ã‚¹å…¥åŠ›ã‚’ä½“é¨“ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚";
        document.getElementById("h2").innerHTML = "ã‚ãªãŸã®ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„";
        document.getElementById("volume").innerHTML = "éŸ³é‡";
        document.getElementById("start").innerHTML = "ã¯ã˜ã‚ã‚‹";
        document.getElementById("inputName").innerHTML = "åå‰å…¥åŠ›";
        document.getElementById("change_playback").innerHTML = "å¤‰æ›ãƒ»å†ç”Ÿ";
        document.getElementById("inputMores").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹å…¥åŠ›";
        document.getElementById("finish").innerHTML = "å®Œäº†";
        document.getElementById("input").innerHTML = "ã²ã‚‰ãŒãªã§å…¥åŠ›ã—ã¦ã­ï¼";
        document.getElementById("nameInput").placeholder = "ãŠåå‰ã‚’ã²ã‚‰ãŒãªã§å…¥åŠ›";
        document.getElementById("back").innerHTML = "æˆ»ã‚‹";
        document.getElementById("change").innerHTML = "å¤‰æ›ã™ã‚‹";
        document.getElementById("GoToHenkan").innerHTML = "å¤‰æ›ã ã‘ã™ã‚‹";
        document.getElementById("henkan-h2").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã«å¤‰æ›ã—ã¾ã—ãŸï¼";
        document.getElementById("marusu2").innerHTML = "å›ã®åå‰ãŒãƒ¢ãƒ¼ãƒ«ã‚¹ã«ãªã£ãŸï¼";
        document.getElementById("yourName").innerHTML = "<strong id='userName'></strong> ã•ã‚“ã®ãŠåå‰ã¯ï¼š";
        document.getElementById("listen-first").innerHTML = "ğŸ”Š éŸ³ã§èã„ã¦ã¿ã‚‹";
        document.getElementById("MP3").innerHTML = "MP3å¤‰æ›";
        document.getElementById("downloadBtn").innerHTML = "MP3ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
        document.getElementById("back2").innerHTML = "æˆ»ã‚‹";
        document.getElementById("next2").innerHTML = "æ¬¡ã¸é€²ã‚€";
        document.getElementById("h2InputExp").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹å…¥åŠ›ã‚’ä½“é¨“ã—ã¦ã¿ã‚ˆã†ï¼";
        document.getElementById("explainHow").innerHTML = "ä»Šåº¦ã¯è‡ªåˆ†ã®åå‰ã‚’ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã§å…¥åŠ›ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>\
        ã€Œãƒ»ã€ï¼ˆçŸ­éŸ³ï¼‰ã¨ã€Œï¼ã€ï¼ˆé•·éŸ³ï¼‰ã¨ã€Œï¼ã€(åŒºåˆ‡ã‚Š) ã‚’çµ„ã¿åˆã‚ã›ã¦æ–‡å­—ã‚’ä½œã‚Šã¾ã™ã€‚";
        document.getElementById("morseInput").placeholder = "ãƒœã‚¿ãƒ³ã§å…¥åŠ›ã—ã¦ãã ã•ã„";
        document.getElementById("HowToPlay").innerHTML = "ãƒœã‚¿ãƒ³ã§ãƒ¢ãƒ¼ãƒ«ã‚¹è¨˜å·ã‚’å…¥åŠ›ã§ãã¾ã™ã€‚<br>\
      DEL: ä¸€æ–‡å­—æ¶ˆã™<br>\
      C: å…¨ã¦æ¶ˆã™<br>\
      ğŸ”Š: ç¾åœ¨ã®ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·å†ç”Ÿãƒ»ç¢ºèª<br>";
        document.getElementById("Tips").innerHTML = " ãƒ»ç›´æ¥ã®æ–‡å­—å…¥åŠ›ã¯ç„¡åŠ¹<br>\
        ãƒ»æŒ¿å…¥ä½ç½®ã‚’æŒ‡å®šã—ã¦å‰Šé™¤å¯èƒ½<br>";
        document.getElementById("checkMyAnswer").innerHTML = "âœ…ç­”ãˆåˆã‚ã›";
        document.getElementById("Tips2").innerHTML = "è‡ªåˆ†ã®åå‰ãŒå®Œæˆã—ãŸã‚‰å…ˆã«é€²ã‚ã¾ã™ã€‚\
        <br>ã€Œâœ…ç­”ãˆåˆã‚ã›ã€ã§ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼";
        document.getElementById("back3").innerHTML = "æˆ»ã‚‹";
        document.getElementById("next3").innerHTML = "çµ‚ã‚ã‚Šã«ã™ã‚‹";
        document.getElementById("otsukare").innerHTML = "ğŸ‰ ãŠã¤ã‹ã‚Œã•ã¾ã§ã—ãŸï¼";
        document.getElementById("thanksMessage").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ã®ä½“é¨“ã¯ã„ã‹ãŒã§ã—ãŸã‹ï¼Ÿ<br>\
        æ˜”ã®äººãŸã¡ã¯ã“ã®æ–¹æ³•ã§é ãã®äººã¨<br>\
        ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã£ã¦ã„ãŸã‚“ã§ã™ã­ã€‚";
        document.getElementById("suggest").innerHTML = "ã‚¯ã‚¤ã‚ºã«æŒ‘æˆ¦ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ";
        document.getElementById("back4").innerHTML = "æœ€åˆã‹ã‚‰";
        document.getElementById("next4").innerHTML = "ç°¡å˜ã‚¯ã‚¤ã‚º";
        document.getElementById("quiz-question").innerHTML = "è³ªå•ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™";
        document.getElementById("allFinish").innerHTML = "çµ‚äº†";
        document.getElementById("quiz-next-btn").innerHTML = "æ¬¡ã¸";
        document.getElementById("settings").innerHTML = "è¨­å®š";
        document.getElementById("language").innerHTML = "ä½¿ç”¨è¨€èª";
        document.getElementById("volume").innerHTML = "éŸ³é‡";
        document.getElementById("frequency").innerHTML = "å‘¨æ³¢æ•°";
        document.getElementById("speed").innerHTML = "å†ç”Ÿé€Ÿåº¦";
        document.getElementById("resetSettings").innerHTML = "åˆæœŸè¨­å®šã«æˆ»ã™";
        document.getElementById("closeSettings").innerHTML = "é–‰ã˜ã‚‹";
        document.getElementById("mo-rusuhenkanjo").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹å¤‰æ›æ‰€";
        document.getElementById("input_henkan").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹ã®è§£æã‚„å¤‰æ›ãŒå‡ºæ¥ã‚‹ã‚ˆï¼";
        document.getElementById("kaiseki").innerHTML = "è§£æ (Upload & Analyze)";
        if(languageName === "æ—¥æœ¬èª" ){
            document.getElementById("kaiseki_help").innerHTML = "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ã€Œè§£æã™ã‚‹ã€ã‚’æŠ¼ã™ã¨ã€æ¤œå‡ºã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ«ã‚¹è¨˜å·ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br>\
            <b>ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯æ—¥æœ¬èª(ã‹ãª)ã§ã™ã€‚</b><br>(The current language in use is not English.)";
        }else if(languageName === "ãƒ­ãƒ¼ãƒå­—" ){
            document.getElementById("kaiseki_help").innerHTML = "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ã€Œè§£æã™ã‚‹ã€ã‚’æŠ¼ã™ã¨ã€æ¤œå‡ºã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ«ã‚¹è¨˜å·ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br>\
            <b>ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯æ—¥æœ¬èª(ãƒ­ãƒ¼ãƒå­—)ã§ã™ã€‚</b><br>(The current language in use is not English.)";
        }
        document.getElementById("audiofile").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹éŸ³å£°(mp3)ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦è§£æ:";
        document.getElementById("analyzeInfo").innerHTML = "è§£æçµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ â†‘";
        document.getElementById("h3_henkan").innerHTML = "å¤‰æ› (Convert Text)";
        if(languageName === "æ—¥æœ¬èª" ){
            document.getElementById("henkan_help").innerHTML = "ã“ã“ã«å¤‰æ›ã—ãŸã„æ–‡å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä½¿ç”¨è¨€èªã«ã¯æ³¨æ„ã—ã¦ãã ã•ã„ã€‚<br>\
            <b>ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯æ—¥æœ¬èª(ã‹ãª)ã§ã™ã€‚</b><br>(The current language in use is not English.)";
        }else if(languageName === "ãƒ­ãƒ¼ãƒå­—" ){
            document.getElementById("henkan_help").innerHTML = "ã“ã“ã«å¤‰æ›ã—ãŸã„æ–‡å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä½¿ç”¨è¨€èªã«ã¯æ³¨æ„ã—ã¦ãã ã•ã„ã€‚<br>\
            <b>ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯æ—¥æœ¬èª(ãƒ­ãƒ¼ãƒå­—)ã§ã™ã€‚</b><br>(The current language in use is not English.)";
        }
        document.getElementById("WantToChange").placeholder = "å¤‰æ›ã—ãŸã„æ–‡å­—ã‚’å…¥åŠ›";
        document.getElementById("hanken_help2").innerHTML = "å…¥åŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã¯è‡ªå‹•ã§ãƒ¢ãƒ¼ãƒ«ã‚¹ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ”ãƒ¼ã‚„å†ç”Ÿã€MP3ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå¯èƒ½ã§ã™ã€‚";
        document.getElementById("copyWantToChangeBtn").innerHTML = "ã‚³ãƒ”ãƒ¼";
        document.getElementById("playWantToChangeBtn").innerHTML = "ğŸ”Š å†ç”Ÿ";
        document.getElementById("downloadWantToChangeBtn").innerHTML = "MP3ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
        document.getElementById("copyWantToChangeMsg").innerHTML = "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ";
        document.getElementById("Separator").innerHTML = "åŒºåˆ‡ã‚Šè¨˜å·:";
        document.getElementById("ï¼").innerHTML = "å…¨è§’ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆï¼ï¼‰";
        document.getElementById("/").innerHTML = "åŠè§’ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆ/ï¼‰";
        document.getElementById("space").innerHTML = "ã‚¹ãƒšãƒ¼ã‚¹";
        document.getElementById("WantToChangeShowUnknowns").innerHTML = "æœªå®šç¾©æ–‡å­—(ï¼Ÿ)ã‚’è¡¨ç¤º";
        document.getElementById("backToFst").innerHTML = "æœ€åˆã®ç”»é¢ã¸";
        document.getElementById("morseTbl").innerHTML = "ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·è¡¨";
        document.getElementById("moji").textContent = "æ–‡å­—";
        document.getElementById("hugou").textContent = "ãƒ¢ãƒ¼ãƒ«ã‚¹ç¬¦å·";
        document.getElementById("morseTblBtn").textContent = "ğŸ“– ãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·è¡¨";
        
        
    }else{
        current_language = rome;
        console.log("English\n");
        document.getElementById("h1").innerHTML = "ğŸµ Morse Code Experience App ğŸ“¡";
        document.getElementById("inline-character-balloon").innerHTML = "Let's learn Morse code together!";
        document.getElementById("welcome-text").innerHTML = "Welcome to the world of Morse code!<br>\
        Convert your name into Morse code, and try experiencing Morse code input for yourself.";
        document.getElementById("h2").innerHTML = "Please tell me your name.";
        document.getElementById("volume").innerHTML = "Volume";
        document.getElementById("start").innerHTML = "Start";
        document.getElementById("inputName").innerHTML = "Input your name.";
        document.getElementById("change_playback").innerHTML = "Conversion and Playback";
        document.getElementById("inputMores").innerHTML = "Morse code input";
        document.getElementById("finish").innerHTML = "Completed";
        document.getElementById("input").innerHTML = "Please type inalphabet letters!";
        document.getElementById("nameInput").placeholder = "Please enter your name.";
        document.getElementById("back").innerHTML = "Back";
        document.getElementById("change").innerHTML = "Convert";
        document.getElementById("GoToHenkan").innerHTML = "Conversion only";
        document.getElementById("henkan-h2").innerHTML = "Converted to Morse code!";
        document.getElementById("marusu2").innerHTML = "Your name has become Morse code!";
        document.getElementById("yourName").innerHTML = "<strong id=â€˜userNameâ€™></strong>'s name is:";
        document.getElementById("listen-first").innerHTML = "ğŸ”Š Listen to it";
        document.getElementById("MP3").innerHTML = "MP3 Conversion";
        document.getElementById("downloadBtn").innerHTML = "Download MP3";
        document.getElementById("back2").innerHTML = "Back";
        document.getElementById("next2").innerHTML = "Next";
        document.getElementById("h2InputExp").innerHTML = "Try out Morse code input!";
        document.getElementById("explainHow").innerHTML = "Now let's try entering your name in Morse code.<br>\
Combine dots (Â·), dashes (ï¼), and slashes (/) to form letters.";
        document.getElementById("morseInput").placeholder = "Please enter using the button.";
        document.getElementById("HowToPlay").innerHTML = "You can input Morse code using the buttons.<br>\
      DEL: Delete one character<br>\
      C: Clear All<br>\
      ğŸ”Š: Current Morse code playback and verification<br>";
        document.getElementById("Tips").innerHTML = " ãƒ»Direct text input is disabled<br>\
        ãƒ»Deletion possible by specifying insertion position<br>";
        document.getElementById("checkMyAnswer").innerHTML = "âœ…Check My Answer";
        document.getElementById("Tips2").innerHTML = "Once your name is complete, you can proceed.\
        <br>Check your answers with â€œâœ… Check My Answerâ€!";
        document.getElementById("back3").innerHTML = "Back";
        document.getElementById("next3").innerHTML = "End it";
        document.getElementById("otsukare").innerHTML = "ğŸ‰ Great job!";
        document.getElementById("thanksMessage").innerHTML = "How was your experience with Morse code?<br>\
        People in the old days used this method to communicate with those far away.";
        document.getElementById("suggest").innerHTML = "Why not give the quiz a try?";
        document.getElementById("back4").innerHTML = "Return to the first page";
        document.getElementById("next4").innerHTML = "Simple Quiz";
        document.getElementById("quiz-question").innerHTML = "Questions will appear here.";
        document.getElementById("allFinish").innerHTML = "End";
        document.getElementById("quiz-next-btn").innerHTML = "Next";
        document.getElementById("settings").innerHTML = "Settings";
        document.getElementById("language").innerHTML = "Language used";
        document.getElementById("volume").innerHTML = "Volume";
        document.getElementById("frequency").innerHTML = "Frequency";
        document.getElementById("speed").innerHTML = "Playback speed";
        document.getElementById("resetSettings").innerHTML = "Reset to factory settings";
        document.getElementById("closeSettings").innerHTML = "Close";
        document.getElementById("mo-rusuhenkanjo").innerHTML = "Morse Code Station";
        document.getElementById("input_henkan").innerHTML = "You can analyze and convert Morse code!";
        document.getElementById("kaiseki").innerHTML = "è§£æ (Upload & Analyze)";
        document.getElementById("kaiseki_help").innerHTML = "Select a file and press â€œAnalyzeâ€ to display the detected Morse code.<br>\
        <b>The current language in use is English.</b><br>(ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯è‹±èªã§ã™ã€‚)";
        document.getElementById("audiofile").innerHTML = "Upload Morse code audio (mp3) for analysis:";
        document.getElementById("analyzeInfo").innerHTML = "Analysis results will be displayed â†‘";
        document.getElementById("h3_henkan").innerHTML = "å¤‰æ› (Convert Text)";
        document.getElementById("henkan_help").innerHTML = "Enter the text you want to convert here. Please be mindful of the language used.<br>\
        <b>The current language in use is English.</b><br>(ç¾åœ¨ã®ä½¿ç”¨è¨€èªã¯è‹±èªã§ã™ã€‚)";
        document.getElementById("WantToChange").placeholder = "Enter the text you want to convert";
        document.getElementById("hanken_help2").innerHTML = "The text you enter is automatically converted to Morse code. You can copy, play back, or download it as an MP3 file.";
        document.getElementById("copyWantToChangeBtn").innerHTML = "Copy";
        document.getElementById("playWantToChangeBtn").innerHTML = "ğŸ”Š Play";
        document.getElementById("downloadWantToChangeBtn").innerHTML = "MP3 Download";
        document.getElementById("copyWantToChangeMsg").innerHTML = "Copied";
        document.getElementById("Separator").innerHTML = "Delimiter:";
        document.getElementById("ï¼").innerHTML = "Full-width slash (ï¼)";
        document.getElementById("/").innerHTML = "Half-width slash (/)";
        document.getElementById("space").innerHTML = "Space";
        document.getElementById("WantToChangeShowUnknowns").innerHTML = "Display undefined character (?)";
        document.getElementById("backToFst").innerHTML = "Back to the first screen";
        document.getElementById("morseTbl").innerHTML = "Morse Code Chart";
        document.getElementById("moji").textContent = "Characters";
        document.getElementById("hugou").textContent = "Morse code";
        document.getElementById("morseTblBtn").textContent = "ğŸ“– Morse Code Chart";
    }
}


